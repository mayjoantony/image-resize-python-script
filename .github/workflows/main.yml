on:
  pull_request:
    branches:
      - main
      - master
  push:
    branches:
      - main
      - master
name: "Build & Release"
jobs:
  build:
    name: Build & Release
    runs-on: ubuntu-latest
    steps:
      # # Build and publish to pipy - New registration is blocked by pypi - waiting for the approval
      # - uses: actions/checkout@v2
      # - name: Set up Python 3.8
      #   uses: actions/setup-python@v2
      #   with:
      #     python-version: 3.8
      #     scripts: dist/
      # - name: Install dependencies
      #   run: |
      #     python -m pip install --upgrade pip
      #     if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
      # - name: Build and publish
      #   run: |
      #     pip install setuptools wheel twine
      #     python setup.py sdist bdist_wheel
      #     twine upload dist/* --username ${{ secrets.PYPI_USERNAME }} --password ${{ secrets.PYPI_PASSWORD }}
      #   env:
      #     PYPI_USERNAME: ${{ secrets.PYPI_USERNAME }}
      #     PYPI_PASSWORD: ${{ secrets.PYPI_PASSWORD }}
      - name: Push to Releases
        uses: ncipollo/release-action@v1
        with:
          tag: v1.0.${{ github.run_number }}
          token: ${{ secrets.WORKFLOW_TOKEN }}
